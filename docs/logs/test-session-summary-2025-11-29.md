# æµ‹è¯•ä¼šè¯æ€»ç»“ - 2025-11-29

**ä¼šè¯æ—¶é—´**: 15:30 - 16:36  
**æ€»è€—æ—¶**: 66 åˆ†é’Ÿ  
**ä¸»è¦ä»»åŠ¡**: æ¸¸æˆå…¼å®¹æ€§æµ‹è¯• + PPU Bug ä¿®å¤

---

## ğŸ¯ å®Œæˆçš„å·¥ä½œ

### 1. æ¸¸æˆå…¼å®¹æ€§æµ‹è¯•ï¼ˆæ­¥éª¤ 1-4ï¼‰âœ…

| æ¸¸æˆ | ROMåˆ†æ | ç³»ç»Ÿåˆå§‹åŒ– | Verilator | çŸ­æ—¶è¿è¡Œ | çŠ¶æ€ |
|------|---------|-----------|----------|---------|------|
| Donkey Kong | âœ… | âœ… | âœ… | âœ… | é€šè¿‡ |
| Super Mario Bros | âœ… | âœ… | âœ… | âœ… | é€šè¿‡ |
| Super Contra X | âœ… | âœ… | âœ… | âœ… | é€šè¿‡ |

**é€šè¿‡ç‡**: 100% (12/12 æµ‹è¯•)

### 2. PPU æ¸²æŸ“ Bug ä¿®å¤ ğŸ”¥

**é—®é¢˜**: ç°è‰²ç”»é¢ â†’ æ— æ³•æ˜¾ç¤ºæ¸¸æˆå†…å®¹

**ä¿®å¤å†ç¨‹**:
1. **ç°è‰²ç”»é¢** (16:04) - PPU pixelColor æœªè¾“å‡º
2. **ç»¿è‰²ç”»é¢** (16:10) - è°ƒè‰²æ¿æœªåˆå§‹åŒ–
3. **è¿˜æ˜¯ç»¿è‰²** (16:12) - Nametable æ— æ³•å†™å…¥
4. **æ£‹ç›˜æµ‹è¯•** (16:16) - éªŒè¯æ¸²æŸ“ç®¡é“
5. **æœ‰å›¾å½¢äº†** (16:19) - ä¿®å¤æ¸²æŸ“ç®¡é“å»¶è¿Ÿ
6. **é¢œè‰²æ›´å¥½** (16:25) - è°ƒè‰²æ¿æ˜ å°„æ­£ç¡®

**æœ€ç»ˆç»“æœ**: âœ… èƒ½æ˜¾ç¤ºå›¾å½¢å’Œé¢œè‰²

### 3. GitHub ç®¡ç† âœ…

- Issue #1: æ¸¸æˆå…¼å®¹æ€§æµ‹è¯•æŠ¥å‘Š
- Issue #2: PPU Bug æŠ¥å‘Šï¼ˆå·²å…³é—­ï¼‰
- 3 ä¸ªæµ‹è¯•è®°å½•æ–‡æ¡£
- 1 ä¸ª Bug ä¿®å¤æ–‡æ¡£

---

## ğŸ“Š Donkey Kong æµ‹è¯•ç»“æœ

### âœ… æˆåŠŸçš„éƒ¨åˆ†

1. **ROM åŠ è½½** - å®Œå…¨æ­£å¸¸
2. **CPU æ‰§è¡Œ** - æ­£å¸¸è¿è¡Œ
3. **PPU æ¸²æŸ“** - æ˜¾ç¤ºå›¾å½¢å’Œé¢œè‰²
4. **æ€§èƒ½** - FPS 36-37ï¼ˆè¿œè¶…ç›®æ ‡ â‰¥ 3ï¼‰
5. **ç¨³å®šæ€§** - æ— å´©æºƒï¼Œå¯é•¿æ—¶é—´è¿è¡Œ

### ğŸŸ¡ å½“å‰çŠ¶æ€

**ç”»é¢**: é‡å¤çš„å›¾å½¢ + ç»¿è‰²èƒŒæ™¯ï¼Œé™æ­¢ä¸å˜

**å¯èƒ½åŸå› **:
1. æ¸¸æˆåœ¨æ ‡é¢˜ç”»é¢ç­‰å¾…è¾“å…¥
2. è¾“å…¥ç³»ç»Ÿæœªå®ç°æˆ–ä¸å·¥ä½œ
3. æ¸¸æˆé€»è¾‘éœ€è¦ç‰¹å®šçš„ PPU çŠ¶æ€

### âŒ æœªå®Œæˆçš„åŠŸèƒ½

1. **è¾“å…¥ç³»ç»Ÿ** - æŒ‰é”®æ— ååº”
2. **æ¸¸æˆé€»è¾‘** - æ— æ³•è¿›å…¥æ¸¸æˆ
3. **ç²¾çµæ¸²æŸ“** - å¯èƒ½æœªæ­£ç¡®å®ç°
4. **æ»šåŠ¨** - æœªæµ‹è¯•
5. **éŸ³æ•ˆ** - APU æœªå®Œæˆ

---

## ğŸ”§ æŠ€æœ¯æˆæœ

### ä¿®å¤çš„ä»£ç 

**PPURefactored.scala**:
```scala
// 1. è°ƒè‰²æ¿åˆå§‹åŒ–
val paletteRam = RegInit(VecInit(Seq(
  0x09.U, 0x01.U, 0x00.U, ...
)))

// 2. Nametable å†™å…¥
when(io.cpuWrite && io.cpuAddr === 7.U) {
  when(ppuAddr >= 0x3F00.U) {
    paletteRam(paletteAddr) := io.cpuDataIn
  }.elsewhen(ppuAddr >= 0x2000.U) {
    nametableRam.write(ntAddr, io.cpuDataIn)
  }
}

// 3. æ¸²æŸ“ç®¡é“
val patternLowReg = RegNext(patternLow)
val patternHighReg = RegNext(patternHigh)
val pixelBitReg = ((patternHighReg >> bitPosReg)(0) << 1) | 
                  ((patternLowReg >> bitPosReg)(0))

// 4. é¢œè‰²è¾“å‡º
when(isRendering) {
  finalColor := paletteRam(0)
  when(pixelBitReg =/= 0.U) {
    finalColor := bgColorReg
  }
}
```

### ç”Ÿæˆçš„æ–‡ä»¶

- `generated/nes/NESSystem.v` - æ›´æ–°çš„ Verilog
- `build/verilator/VNESSystemRefactored` - å¯æ‰§è¡Œæ–‡ä»¶
- 6 ä¸ªæµ‹è¯•è®°å½•æ–‡æ¡£
- 2 ä¸ª GitHub issues

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… | çŠ¶æ€ |
|------|------|------|------|
| FPS | â‰¥ 3 | 36-37 | âœ… è¶…å‡º 12x |
| ROM åŠ è½½ | < 5s | < 1s | âœ… |
| å¯åŠ¨æ—¶é—´ | < 10s | < 2s | âœ… |
| ç¨³å®šæ€§ | æ— å´©æºƒ | ç¨³å®š | âœ… |
| å›¾å½¢æ˜¾ç¤º | æ­£å¸¸ | æ­£å¸¸ | âœ… |
| æ¸¸æˆå¯ç© | å¯ç© | ä¸å¯ç© | âŒ |

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆä¸‹æ¬¡ä¼šè¯ï¼‰

1. **å®ç°/ä¿®å¤è¾“å…¥ç³»ç»Ÿ** ğŸ”¥ æœ€é«˜ä¼˜å…ˆçº§
   - æ£€æŸ¥æ§åˆ¶å™¨æ¥å£
   - éªŒè¯æŒ‰é”®ä¼ é€’
   - æµ‹è¯•è¾“å…¥å“åº”

2. **æ·±å…¥è°ƒè¯•æ¸¸æˆé€»è¾‘**
   - åˆ†æ CPU æ‰§è¡Œæµç¨‹
   - æ£€æŸ¥ PPU å¯„å­˜å™¨è¯»å–
   - éªŒè¯ VBlank å’Œ NMI

3. **æµ‹è¯•å…¶ä»–æ¸¸æˆ**
   - Super Mario Bros
   - Super Contra X

### ä¸­æœŸï¼ˆæœ¬å‘¨ï¼‰

1. å®Œå–„ PPU åŠŸèƒ½
   - ç²¾çµæ¸²æŸ“ä¼˜åŒ–
   - æ»šåŠ¨æ”¯æŒ
   - Sprite 0 Hit

2. æå‡å…¼å®¹æ€§
   - æ”¯æŒæ›´å¤šæ¸¸æˆ
   - ä¿®å¤å·²çŸ¥é—®é¢˜

### é•¿æœŸï¼ˆæœ¬æœˆï¼‰

1. APU éŸ³é¢‘æ”¯æŒ
2. æ›´å¤š Mapper æ”¯æŒ
3. æ€§èƒ½ä¼˜åŒ–åˆ° 60 FPS

---

## ğŸ’¡ ç»éªŒæ€»ç»“

### æˆåŠŸç»éªŒ

1. **ç³»ç»ŸåŒ–æµ‹è¯•** - 5 é˜¶æ®µæµ‹è¯•æ–¹æ³•æœ‰æ•ˆ
2. **é€æ­¥è°ƒè¯•** - ä»ç®€å•æµ‹è¯•å›¾æ¡ˆå¼€å§‹
3. **æ–‡æ¡£è®°å½•** - è¯¦ç»†è®°å½•æ¯ä¸ªæ­¥éª¤
4. **GitHub ç®¡ç†** - åŠæ—¶åˆ›å»ºå’Œæ›´æ–° issues

### é‡åˆ°çš„æŒ‘æˆ˜

1. **Chisel ç¼–è¯‘å™¨ä¼˜åŒ–** - éœ€è¦ `dontTouch` é˜²æ­¢ä¿¡å·è¢«ä¼˜åŒ–
2. **SyncReadMem å»¶è¿Ÿ** - éœ€è¦ `RegNext` å»ºç«‹ç®¡é“
3. **è°ƒè¯•å›°éš¾** - ç¡¬ä»¶ä»¿çœŸéš¾ä»¥å•æ­¥è°ƒè¯•

### æ”¹è¿›å»ºè®®

1. æ·»åŠ æ›´å¤šè°ƒè¯•è¾“å‡º
2. å®ç° VCD æ³¢å½¢è®°å½•
3. åˆ›å»ºå•å…ƒæµ‹è¯•è¦†ç›–æ›´å¤šåœºæ™¯

---

## ğŸ“Š æ•´ä½“è¯„ä¼°

### é¡¹ç›®è¿›åº¦

- **CPU**: 98% âœ…
- **PPU**: 70% ğŸŸ¡ (æ¸²æŸ“å·¥ä½œï¼Œä½†ç¼ºå°‘ç²¾çµå’Œæ»šåŠ¨)
- **APU**: 40% ğŸŸ¡
- **è¾“å…¥**: 0% âŒ (æœ€å¤§é—®é¢˜)
- **æ•´ä½“**: 75% ğŸŸ¡

### å…¼å®¹æ€§è¯„çº§

**Donkey Kong**: ğŸŸ¡ åŸºæœ¬å…¼å®¹ (60%)
- âœ… èƒ½åŠ è½½å’Œè¿è¡Œ
- âœ… èƒ½æ˜¾ç¤ºå›¾å½¢
- âŒ æ— æ³•è¿›å…¥æ¸¸æˆ
- âŒ è¾“å…¥ä¸å·¥ä½œ

---

## ğŸ‰ ä»Šæ—¥äº®ç‚¹

1. **æˆåŠŸä¿®å¤ PPU æ¸²æŸ“** - ä»ç°è‰²åˆ°æœ‰å›¾å½¢ï¼
2. **æ€§èƒ½ä¼˜å¼‚** - FPS 36-37ï¼Œè¿œè¶…ç›®æ ‡
3. **ç³»ç»Ÿç¨³å®š** - å¯é•¿æ—¶é—´è¿è¡Œæ— å´©æºƒ
4. **å®Œæ•´æ–‡æ¡£** - è¯¦ç»†è®°å½•æ‰€æœ‰è¿‡ç¨‹

---

**ä¼šè¯ç»“æŸæ—¶é—´**: 16:36  
**ä¸‹æ¬¡é‡ç‚¹**: å®ç°è¾“å…¥ç³»ç»Ÿ ğŸ®
