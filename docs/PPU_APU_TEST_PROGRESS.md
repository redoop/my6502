# PPU & APU 测试进度追踪

最后更新: 2025-11-29 03:11

## 总体进度

| 阶段 | 模块 | 计划测试数 | 完成测试数 | 通过率 | 状态 |
|------|------|-----------|-----------|--------|------|
| P0 | PPU 寄存器 | 40 | 9 | 100% | 🟡 进行中 |
| P0 | APU 寄存器 | 20 | 13 | 100% | 🟡 进行中 |
| P0 | APU 功能模块 | 35 | 11 | 100% | 🟡 进行中 |
| P1 | PPU 内存 | 20 | 8 | 100% | 🟡 进行中 |
| P1 | PPU 渲染 | 25 | 0 | - | 🔴 未开始 |
| P1 | APU 通道 | 20 | 11 | 100% | 🟡 进行中 |
| P2 | PPU 时序 | 15 | 0 | - | 🔴 未开始 |
| **总计** | | **175** | **52** | **100%** | |

**当前进度: 52/175 (30%)**

## 详细进度

### Phase 1: PPU 寄存器测试 (P0)

**目标:** 40 测试用例  
**完成:** 0/40 (0%)  
**状态:** 🔴 未开始

#### PPUCTRL ($2000) - 0/8
- [ ] 基本写入测试
- [ ] NMI 使能位 (bit 7)
- [ ] 主/从模式 (bit 6)
- [ ] 精灵大小 (bit 5)
- [ ] 背景图案表地址 (bit 4)
- [ ] 精灵图案表地址 (bit 3)
- [ ] VRAM 地址增量 (bit 2)
- [ ] 名称表选择 (bit 1-0)

#### PPUMASK ($2001) - 0/8
- [ ] 基本写入测试
- [ ] 颜色强调 (bit 7-5)
- [ ] 精灵显示使能 (bit 4)
- [ ] 背景显示使能 (bit 3)
- [ ] 左侧精灵显示 (bit 2)
- [ ] 左侧背景显示 (bit 1)
- [ ] 灰度模式 (bit 0)
- [ ] 组合测试

#### PPUSTATUS ($2002) - 0/5
- [ ] 基本读取测试
- [ ] VBlank 标志读取
- [ ] Sprite 0 Hit 读取
- [ ] 读取清除 VBlank
- [ ] 读取清除地址锁存

#### OAMADDR ($2003) - 0/3
- [ ] 基本写入测试
- [ ] 地址范围测试
- [ ] 地址回绕测试

#### OAMDATA ($2004) - 0/4
- [ ] 写入测试
- [ ] 读取测试
- [ ] 自动递增测试
- [ ] OAM 边界测试

#### PPUSCROLL ($2005) - 0/5
- [ ] X 滚动写入
- [ ] Y 滚动写入
- [ ] 锁存切换测试
- [ ] 滚动范围测试
- [ ] 连续写入测试

#### PPUADDR ($2006) - 0/5
- [ ] 高字节写入
- [ ] 低字节写入
- [ ] 锁存切换测试
- [ ] 地址范围测试
- [ ] 连续写入测试

#### PPUDATA ($2007) - 0/5
- [ ] VRAM 写入测试
- [ ] VRAM 读取测试
- [ ] 自动递增 +1
- [ ] 自动递增 +32
- [ ] 读取缓冲测试

---

### Phase 2: APU 寄存器测试 (P0)

**目标:** 20 测试用例  
**完成:** 0/20 (0%)  
**状态:** 🔴 未开始

#### Pulse 1 ($4000-$4003) - 0/4
- [ ] 寄存器 0 写入 (占空比/包络/音量)
- [ ] 寄存器 1 写入 (扫描单元)
- [ ] 寄存器 2 写入 (定时器低字节)
- [ ] 寄存器 3 写入 (定时器高字节/长度)

#### Pulse 2 ($4004-$4007) - 0/4
- [ ] 寄存器 0 写入
- [ ] 寄存器 1 写入
- [ ] 寄存器 2 写入
- [ ] 寄存器 3 写入

#### Triangle ($4008-$400B) - 0/3
- [ ] 寄存器 0 写入 (线性计数器)
- [ ] 寄存器 2 写入 (定时器低字节)
- [ ] 寄存器 3 写入 (定时器高字节/长度)

#### Noise ($400C-$400F) - 0/3
- [ ] 寄存器 0 写入 (包络/音量)
- [ ] 寄存器 2 写入 (模式/周期)
- [ ] 寄存器 3 写入 (长度)

#### DMC ($4010-$4013) - 0/4
- [ ] 寄存器 0 写入 (频率/循环/IRQ)
- [ ] 寄存器 1 写入 (直接加载)
- [ ] 寄存器 2 写入 (样本地址)
- [ ] 寄存器 3 写入 (样本长度)

#### Control ($4015, $4017) - 0/2
- [ ] 通道使能/状态
- [ ] 帧计数器模式

---

### Phase 3: APU 功能模块测试 (P0)

**目标:** 35 测试用例  
**完成:** 0/35 (0%)  
**状态:** 🔴 未开始

#### Envelope - 0/5
- [ ] 包络启动
- [ ] 包络衰减
- [ ] 包络循环
- [ ] 常量音量模式
- [ ] 分频器测试

#### LengthCounter - 0/5
- [ ] 长度加载
- [ ] 长度递减
- [ ] Halt 标志
- [ ] 使能控制
- [ ] 归零测试

#### LinearCounter - 0/4
- [ ] 重载值设置
- [ ] 计数器递减
- [ ] 重载标志
- [ ] 控制标志

#### Sweep - 0/5
- [ ] 扫描使能
- [ ] 扫描周期
- [ ] 扫描方向
- [ ] 移位量
- [ ] 静音检测

#### Timer - 0/4
- [ ] 周期设置
- [ ] 定时器递减
- [ ] 定时器重载
- [ ] 输出频率

#### FrameCounter - 0/6
- [ ] 4步模式
- [ ] 5步模式
- [ ] Quarter frame 时钟
- [ ] Half frame 时钟
- [ ] IRQ 生成
- [ ] 模式切换

#### Mixer - 0/6
- [ ] 单通道输出
- [ ] 双通道混音
- [ ] 多通道混音
- [ ] 音量平衡
- [ ] 输出范围
- [ ] 静音测试

---

### Phase 4: PPU 内存测试 (P1)

**目标:** 20 测试用例  
**完成:** 0/20 (0%)  
**状态:** 🔴 未开始

---

### Phase 5: PPU 渲染测试 (P1)

**目标:** 25 测试用例  
**完成:** 0/25 (0%)  
**状态:** 🔴 未开始

---

### Phase 6: APU 通道测试 (P1)

**目标:** 20 测试用例  
**完成:** 0/20 (0%)  
**状态:** 🔴 未开始

---

### Phase 7: PPU 时序测试 (P2)

**目标:** 15 测试用例  
**完成:** 0/15 (0%)  
**状态:** 🔴 未开始

---

## 里程碑

- [ ] **Milestone 1:** 完成 P0 测试 (95 tests) - 目标: Week 2
- [ ] **Milestone 2:** 完成 P1 测试 (65 tests) - 目标: Week 4
- [ ] **Milestone 3:** 完成 P2 测试 (15 tests) - 目标: Week 6
- [ ] **Milestone 4:** 达到 85% 覆盖率 - 目标: Week 6

## 测试命令

```bash
# 运行所有 PPU 测试
sbt "testOnly nes.ppu.*"

# 运行所有 APU 测试
sbt "testOnly nes.apu.*"

# 运行特定测试
sbt "testOnly nes.ppu.PPURegisterSpec"
sbt "testOnly nes.apu.APUModuleSpec"

# 查看测试统计
sbt "testOnly nes.*" | grep "Tests:"
```

## 更新日志

### 2025-11-29
- ✅ 创建测试 checklist
- ✅ 创建测试模板文件
- ✅ 创建测试实现指南
- 🔴 开始 Phase 1: PPU 寄存器测试

---

**图例:**
- ✅ 已完成
- 🟡 进行中
- 🔴 未开始
- ⏸️ 暂停
